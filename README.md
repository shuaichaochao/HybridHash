# HybridHash: Hybrid Convolutional and Self-Attention Deep Hashing for Image Retrieval
## The Overall Architecture Of HybridHash
![brief_architecture](https://github.com/shuaichaochao/HybridHash/assets/49743419/372b311e-1e27-4fc7-bef4-ed1c5b953a17)
Figure.1. The detailed architecture of the proposed HybridHash. We adopt similar segmentation as ViT to divide the image with finer granularity and feed the generated image patches into the Transformer Block. The whole hybrid network consists of three stages to gradually decrease the resolution and increase the channel dimension. Interaction modules followed by each stage to promote the communication of information about the image blocks. Finally, the binary codes are output after the hash layer.
## Image Retrieval Related Work Instructions
There are three main types of prevailing image retrieval hashing methods, which are symmetric Deep Supervised Hashing, Asymmetric Deep Supervised Hashing and Center Similarity Deep Supervised Hashing. They are different. 
### Symmetric Deep Supervised Hashing in Image Retrieval
Due to the rapid development of deep learning, deep supervised hashing methods have achieved superior performance on image retrieval tasks. The majority of these methods are symmetric deep supervised hashing methods such as CNNH[1], DSH[2], DNNH[3], HashNet[4], DCH[5], etc., which exploit the similarity or dissimilarity between pairs of images to learn one deep hash function for query images and database (retrieval) images. Symmetric deep supervised hashing methods utilize only fewer training images and supervised information to obtain superior performance, which have been preferred by many researchers.
### Asymmetric Deep Supervised Hashing in Image Retrieval
Symmetric deep supervised hashing methods are broadly used in image retrieval tasks and have achieved well performance. Nevertheless, the training of these hashing methods is typically time-consuming, which makes them hard to
effectively utilize the supervised information for cases with large-scale database. Asymmetric Deep Supervised Hashing (ADSH)[6] is the first asymmetric strategy method for large-scale nearest neighbor search that treats query images and database (retrieval) images in an asymmetric way. More specifically, ADSH learns a deep hash function only for query points, while the hash codes for database points are directly learned. On this basis, many asymmetric hashing methods have been proposed such as ADMH[7], JLDSH[8]. Each of these methods imposes some extent of improvement on the network architecture or loss function. Compared with traditional symmetric deep supervised hashing methods, asymmetric deep supervised hashing method can utilize the supervised information of database (retrieval) images to obtain superior performance which has better training efficiency. However, it is impractical for tens of millions of images to all have label information.
### Central Similarity Deep Supervised Hashing in Image Retrieval
All of the above deep supervised hashing methods learn hash functions by capturing pairwise or triplet data similarities from a local perspective, which may   harm the discriminability of the generated hash codes. CSQ[9] proposes a new global similarity metric, called central similarity. Here, hash values of similar data points are encouraged to approach a common center, whereas pairs of dissimilar hash codes converge to distinct centers. Immediately after that, MDSHC [10] proposes an optimization method that finds hash centers with a constraint on the minimum distance between any pair of hash centers. The central similarity deep supervised hashing methods can capture the global data distribution, which tackle the problem of data imbalance and generate high-quality hash functions efficiently. 

Therefore the above three types of methods are not generally compared at the same time since it is an unfair comparison. Our proposed HybridHash belongs to the first type of hashing methods mentioned above and hence also compared with only the state-of-the-art hashing methods in the first type.

## Reference
[1] Xia, R.K., Pan, Y., Lai, H.J., Liu, C., Yan, S.C.: Supervised Hashing for Image Retrieval via Image Representation Learning. In: Proceedings of the Twenty-Eighth AAAI Conference on Artificial Intelligence (AAAI), pp. 2156-2162. AAAI, (2014)
