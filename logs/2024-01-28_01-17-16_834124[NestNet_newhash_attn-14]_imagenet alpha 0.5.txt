2024-01-28 01:17:16.851 | INFO     | __main__:<module>:179 - {'alpha': 0.5, 'optimizer': {'type': <class 'torch.optim.rmsprop.RMSprop'>, 'optim_params': {'lr': 2.5e-05, 'weight_decay': 1e-05}, 'lr_type': 'step'}, 'info': '[NestNet_newhash_attn-14]', 'step_continuation': 20, 'resize_size': 256, 'crop_size': 224, 'batch_size': 64, 'dataset': 'imagenet', 'epoch': 12, 'test_map': 3, 'save_path': 'save/HashNet', 'device': device(type='cuda', index=3), 'bit_list': [16, 32, 48, 64], 'pretrained_dir': 'checkpoint/jx_nest_base-8bc41011.pth', 'img_size': 224, 'patch_size': 4, 'in_chans': 3, 'num_work': 4, 'model_type': 'ViT-L_16', 'top_img': 10, 'num_train': 13000, 'num_query': 5000, 'topK': 1000, 'n_class': 100, 'data_path': 'datasets/imagenet', 'data': {'train_set': {'list_path': 'datasets/imagenet/train.txt', 'batch_size': 64}, 'database': {'list_path': 'datasets/imagenet/database.txt', 'batch_size': 64}, 'test': {'list_path': 'datasets/imagenet/test.txt', 'batch_size': 64}}}
2024-01-28 01:17:17.446 | INFO     | utils.tools:get_data:197 - train_set 13000 
2024-01-28 01:17:17.730 | INFO     | utils.tools:get_data:197 - test 5000 
2024-01-28 01:17:22.585 | INFO     | utils.tools:get_data:197 - database 128503 
2024-01-28 01:17:26.931 | INFO     | __main__:train_val:90 - Loading:
2024-01-28 01:17:27.853 | INFO     | __main__:train_val:93 - Pretrain weights loaded.
2024-01-28 01:17:32.910 | INFO     | __main__:train_val:100 - Total Parameter: 	55.57 M
2024-01-28 01:17:32.911 | INFO     | __main__:train_val:101 - Total Flops: 	14.12 GMac
2024-01-28 01:17:37.309 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 1/12][01:17:37] bit:16, dataset:imagenet, training....
2024-01-28 01:19:31.035 | INFO     | __main__:train_val:169 -  loss:1.0126
2024-01-28 01:19:31.036 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 2/12][01:19:31] bit:16, dataset:imagenet, training....
2024-01-28 01:21:24.010 | INFO     | __main__:train_val:169 -  loss:0.9065
2024-01-28 01:21:24.012 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 3/12][01:21:24] bit:16, dataset:imagenet, training....
2024-01-28 01:23:17.080 | INFO     | __main__:train_val:169 -  loss:0.8273
2024-01-28 01:33:26.326 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:3 bit:16 dataset:imagenet MAP:0.8028143364253784 Best MAP: 0.8028143364253784
2024-01-28 01:33:26.337 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 4/12][01:33:26] bit:16, dataset:imagenet, training....
2024-01-28 01:35:20.018 | INFO     | __main__:train_val:169 -  loss:0.8130
2024-01-28 01:35:20.019 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 5/12][01:35:20] bit:16, dataset:imagenet, training....
2024-01-28 01:37:13.468 | INFO     | __main__:train_val:169 -  loss:0.8070
2024-01-28 01:37:13.470 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 6/12][01:37:13] bit:16, dataset:imagenet, training....
2024-01-28 01:39:07.047 | INFO     | __main__:train_val:169 -  loss:0.8031
2024-01-28 01:49:04.915 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:6 bit:16 dataset:imagenet MAP:0.8017609596241914 Best MAP: 0.8028143364253784
2024-01-28 01:49:04.936 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 7/12][01:49:04] bit:16, dataset:imagenet, training....
2024-01-28 01:50:59.201 | INFO     | __main__:train_val:169 -  loss:0.7998
2024-01-28 01:50:59.202 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 8/12][01:50:59] bit:16, dataset:imagenet, training....
2024-01-28 01:52:52.056 | INFO     | __main__:train_val:169 -  loss:0.7971
2024-01-28 01:52:52.058 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 9/12][01:52:52] bit:16, dataset:imagenet, training....
2024-01-28 01:54:46.764 | INFO     | __main__:train_val:169 -  loss:0.7957
2024-01-28 02:04:25.190 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:9 bit:16 dataset:imagenet MAP:0.76971886975757 Best MAP: 0.8028143364253784
2024-01-28 02:04:25.227 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][10/12][02:04:25] bit:16, dataset:imagenet, training....
2024-01-28 02:06:21.743 | INFO     | __main__:train_val:169 -  loss:0.7935
2024-01-28 02:06:21.753 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][11/12][02:06:21] bit:16, dataset:imagenet, training....
2024-01-28 02:08:14.916 | INFO     | __main__:train_val:169 -  loss:0.7923
2024-01-28 02:08:14.922 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][12/12][02:08:14] bit:16, dataset:imagenet, training....
2024-01-28 02:10:08.819 | INFO     | __main__:train_val:169 -  loss:0.7911
2024-01-28 02:19:18.229 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:12 bit:16 dataset:imagenet MAP:0.7093471963749907 Best MAP: 0.8028143364253784
2024-01-28 02:19:19.080 | INFO     | utils.tools:get_data:197 - train_set 13000 
2024-01-28 02:19:19.259 | INFO     | utils.tools:get_data:197 - test 5000 
2024-01-28 02:19:23.961 | INFO     | utils.tools:get_data:197 - database 128503 
2024-01-28 02:19:37.599 | INFO     | __main__:train_val:90 - Loading:
2024-01-28 02:19:38.867 | INFO     | __main__:train_val:93 - Pretrain weights loaded.
2024-01-28 02:19:39.117 | INFO     | __main__:train_val:100 - Total Parameter: 	55.59 M
2024-01-28 02:19:39.120 | INFO     | __main__:train_val:101 - Total Flops: 	14.12 GMac
2024-01-28 02:19:39.177 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 1/12][02:19:39] bit:32, dataset:imagenet, training....
2024-01-28 02:21:40.373 | INFO     | __main__:train_val:169 -  loss:0.9266
2024-01-28 02:21:40.374 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 2/12][02:21:40] bit:32, dataset:imagenet, training....
2024-01-28 02:23:36.763 | INFO     | __main__:train_val:169 -  loss:0.8342
2024-01-28 02:23:36.764 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 3/12][02:23:36] bit:32, dataset:imagenet, training....
2024-01-28 02:25:31.763 | INFO     | __main__:train_val:169 -  loss:0.7755
2024-01-28 02:34:06.712 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:3 bit:32 dataset:imagenet MAP:0.8886419297495602 Best MAP: 0.8886419297495602
2024-01-28 02:34:06.726 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 4/12][02:34:06] bit:32, dataset:imagenet, training....
2024-01-28 02:36:06.332 | INFO     | __main__:train_val:169 -  loss:0.7639
2024-01-28 02:36:06.333 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 5/12][02:36:06] bit:32, dataset:imagenet, training....
2024-01-28 02:38:06.253 | INFO     | __main__:train_val:169 -  loss:0.7578
2024-01-28 02:38:06.254 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 6/12][02:38:06] bit:32, dataset:imagenet, training....
2024-01-28 02:40:02.658 | INFO     | __main__:train_val:169 -  loss:0.7541
2024-01-28 02:48:30.393 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:6 bit:32 dataset:imagenet MAP:0.8774875335413417 Best MAP: 0.8886419297495602
2024-01-28 02:48:30.405 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 7/12][02:48:30] bit:32, dataset:imagenet, training....
2024-01-28 02:50:27.782 | INFO     | __main__:train_val:169 -  loss:0.7512
2024-01-28 02:50:27.784 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 8/12][02:50:27] bit:32, dataset:imagenet, training....
2024-01-28 02:52:25.263 | INFO     | __main__:train_val:169 -  loss:0.7490
2024-01-28 02:52:25.264 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 9/12][02:52:25] bit:32, dataset:imagenet, training....
2024-01-28 02:54:20.838 | INFO     | __main__:train_val:169 -  loss:0.7472
2024-01-28 03:02:38.549 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:9 bit:32 dataset:imagenet MAP:0.860826208343468 Best MAP: 0.8886419297495602
2024-01-28 03:02:38.562 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][10/12][03:02:38] bit:32, dataset:imagenet, training....
2024-01-28 03:04:33.255 | INFO     | __main__:train_val:169 -  loss:0.7451
2024-01-28 03:04:33.256 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][11/12][03:04:33] bit:32, dataset:imagenet, training....
2024-01-28 03:06:30.577 | INFO     | __main__:train_val:169 -  loss:0.7436
2024-01-28 03:06:30.578 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][12/12][03:06:30] bit:32, dataset:imagenet, training....
2024-01-28 03:08:27.003 | INFO     | __main__:train_val:169 -  loss:0.7425
2024-01-28 03:16:44.283 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:12 bit:32 dataset:imagenet MAP:0.8256377951776863 Best MAP: 0.8886419297495602
2024-01-28 03:16:45.006 | INFO     | utils.tools:get_data:197 - train_set 13000 
2024-01-28 03:16:45.181 | INFO     | utils.tools:get_data:197 - test 5000 
2024-01-28 03:16:49.793 | INFO     | utils.tools:get_data:197 - database 128503 
2024-01-28 03:16:54.010 | INFO     | __main__:train_val:90 - Loading:
2024-01-28 03:16:54.817 | INFO     | __main__:train_val:93 - Pretrain weights loaded.
2024-01-28 03:16:55.009 | INFO     | __main__:train_val:100 - Total Parameter: 	55.61 M
2024-01-28 03:16:55.010 | INFO     | __main__:train_val:101 - Total Flops: 	14.12 GMac
2024-01-28 03:16:55.049 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 1/12][03:16:55] bit:48, dataset:imagenet, training....
2024-01-28 03:18:52.371 | INFO     | __main__:train_val:169 -  loss:0.8718
2024-01-28 03:18:52.372 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 2/12][03:18:52] bit:48, dataset:imagenet, training....
2024-01-28 03:20:50.593 | INFO     | __main__:train_val:169 -  loss:0.8035
2024-01-28 03:20:50.594 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 3/12][03:20:50] bit:48, dataset:imagenet, training....
2024-01-28 03:22:50.452 | INFO     | __main__:train_val:169 -  loss:0.7572
2024-01-28 03:31:15.638 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:3 bit:48 dataset:imagenet MAP:0.9090470166059412 Best MAP: 0.9090470166059412
2024-01-28 03:31:15.650 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 4/12][03:31:15] bit:48, dataset:imagenet, training....
2024-01-28 03:33:13.675 | INFO     | __main__:train_val:169 -  loss:0.7446
2024-01-28 03:33:13.676 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 5/12][03:33:13] bit:48, dataset:imagenet, training....
2024-01-28 03:35:11.905 | INFO     | __main__:train_val:169 -  loss:0.7368
2024-01-28 03:35:11.907 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 6/12][03:35:11] bit:48, dataset:imagenet, training....
2024-01-28 03:37:12.612 | INFO     | __main__:train_val:169 -  loss:0.7319
2024-01-28 03:45:50.033 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:6 bit:48 dataset:imagenet MAP:0.9094740957807861 Best MAP: 0.9094740957807861
2024-01-28 03:45:50.045 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 7/12][03:45:50] bit:48, dataset:imagenet, training....
2024-01-28 03:47:48.084 | INFO     | __main__:train_val:169 -  loss:0.7296
2024-01-28 03:47:48.085 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 8/12][03:47:48] bit:48, dataset:imagenet, training....
2024-01-28 03:49:45.445 | INFO     | __main__:train_val:169 -  loss:0.7271
2024-01-28 03:49:45.446 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 9/12][03:49:45] bit:48, dataset:imagenet, training....
2024-01-28 03:51:46.649 | INFO     | __main__:train_val:169 -  loss:0.7245
2024-01-28 04:00:37.640 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:9 bit:48 dataset:imagenet MAP:0.8956281902668012 Best MAP: 0.9094740957807861
2024-01-28 04:00:37.687 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][10/12][04:00:37] bit:48, dataset:imagenet, training....
2024-01-28 04:02:36.594 | INFO     | __main__:train_val:169 -  loss:0.7227
2024-01-28 04:02:36.595 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][11/12][04:02:36] bit:48, dataset:imagenet, training....
2024-01-28 04:04:35.264 | INFO     | __main__:train_val:169 -  loss:0.7215
2024-01-28 04:04:35.265 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][12/12][04:04:35] bit:48, dataset:imagenet, training....
2024-01-28 04:06:34.293 | INFO     | __main__:train_val:169 -  loss:0.7199
2024-01-28 04:15:36.814 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:12 bit:48 dataset:imagenet MAP:0.8823554676381431 Best MAP: 0.9094740957807861
2024-01-28 04:15:37.487 | INFO     | utils.tools:get_data:197 - train_set 13000 
2024-01-28 04:15:37.661 | INFO     | utils.tools:get_data:197 - test 5000 
2024-01-28 04:15:42.206 | INFO     | utils.tools:get_data:197 - database 128503 
2024-01-28 04:15:46.360 | INFO     | __main__:train_val:90 - Loading:
2024-01-28 04:15:47.031 | INFO     | __main__:train_val:93 - Pretrain weights loaded.
2024-01-28 04:15:47.225 | INFO     | __main__:train_val:100 - Total Parameter: 	55.63 M
2024-01-28 04:15:47.226 | INFO     | __main__:train_val:101 - Total Flops: 	14.13 GMac
2024-01-28 04:15:47.264 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 1/12][04:15:47] bit:64, dataset:imagenet, training....
2024-01-28 04:17:46.595 | INFO     | __main__:train_val:169 -  loss:0.8481
2024-01-28 04:17:46.596 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 2/12][04:17:46] bit:64, dataset:imagenet, training....
2024-01-28 04:19:46.190 | INFO     | __main__:train_val:169 -  loss:0.7881
2024-01-28 04:19:46.191 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 3/12][04:19:46] bit:64, dataset:imagenet, training....
2024-01-28 04:21:48.287 | INFO     | __main__:train_val:169 -  loss:0.7457
2024-01-28 04:30:41.609 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:3 bit:64 dataset:imagenet MAP:0.9186587515685258 Best MAP: 0.9186587515685258
2024-01-28 04:30:41.633 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 4/12][04:30:41] bit:64, dataset:imagenet, training....
2024-01-28 04:32:41.016 | INFO     | __main__:train_val:169 -  loss:0.7323
2024-01-28 04:32:41.017 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 5/12][04:32:41] bit:64, dataset:imagenet, training....
2024-01-28 04:34:40.738 | INFO     | __main__:train_val:169 -  loss:0.7253
2024-01-28 04:34:40.739 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 6/12][04:34:40] bit:64, dataset:imagenet, training....
2024-01-28 04:36:43.477 | INFO     | __main__:train_val:169 -  loss:0.7198
2024-01-28 04:45:43.438 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:6 bit:64 dataset:imagenet MAP:0.9210769786151701 Best MAP: 0.9210769786151701
2024-01-28 04:45:43.462 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 7/12][04:45:43] bit:64, dataset:imagenet, training....
2024-01-28 04:47:42.636 | INFO     | __main__:train_val:169 -  loss:0.7149
2024-01-28 04:47:42.637 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 8/12][04:47:42] bit:64, dataset:imagenet, training....
2024-01-28 04:49:42.340 | INFO     | __main__:train_val:169 -  loss:0.7120
2024-01-28 04:49:42.341 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][ 9/12][04:49:42] bit:64, dataset:imagenet, training....
2024-01-28 04:51:42.265 | INFO     | __main__:train_val:169 -  loss:0.7092
2024-01-28 05:00:56.352 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:9 bit:64 dataset:imagenet MAP:0.9060299593041143 Best MAP: 0.9210769786151701
2024-01-28 05:00:56.377 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][10/12][05:00:56] bit:64, dataset:imagenet, training....
2024-01-28 05:02:56.070 | INFO     | __main__:train_val:169 -  loss:0.7071
2024-01-28 05:02:56.071 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][11/12][05:02:56] bit:64, dataset:imagenet, training....
2024-01-28 05:04:55.465 | INFO     | __main__:train_val:169 -  loss:0.7051
2024-01-28 05:04:55.467 | INFO     | __main__:train_val:131 - [NestNet_newhash_attn-14][12/12][05:04:55] bit:64, dataset:imagenet, training....
2024-01-28 05:06:55.439 | INFO     | __main__:train_val:169 -  loss:0.7043
2024-01-28 05:16:07.180 | INFO     | utils.tools:validate:339 - [NestNet_newhash_attn-14] epoch:12 bit:64 dataset:imagenet MAP:0.9021867531399208 Best MAP: 0.9210769786151701
